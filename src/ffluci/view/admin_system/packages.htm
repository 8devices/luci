<%+header%>
<h1><%:system System%></h1>
<h2><%:packages Paketverwaltung%></h2>

<br />

<% if install or remove or update or upgrade then %>
<div class="code"><strong><%:status Status%>:</strong><br />
<% if update then %>
	<%:packages_update Paketlisten aktualisieren%>: <% if update == 0 then %><span class="ok"><%:ok OK%></span><% else %><span class="error"><%:error Fehler%> (<%:code Code%> <%=update%>)</span><% end %><br />
<% end %>
<% if upgrade then%>
	<%:packages_upgrade Installierte Pakete aktualisieren%>: <% if upgrade == 0 then %><span class="ok"><%:ok OK%></span><% else %><span class="error"><%:error Fehler%> (<%:code Code%> <%=upgrade%>)</span><% end %><br />
<% end %>
<% if install then for k,v in pairs(install) do %>
	<%:packages_install Installation von%> '<%=k%>': <% if v == 0 then %><span class="ok"><%:ok OK%></span><% else %><span class="error"><%:error Fehler%> (<%:code Code%> <%=v%>)</span><% end %><br />
<% end end %>
<% if remove then for k,v in pairs(remove) do %>
	<%:packages_remove Deinstallation von%> '<%=k%>': <% if v == 0 then %><span class="ok"><%:ok OK%></span><% else %><span class="error"><%:error Fehler%> (<%:code Code%> <%=v%>)</span><% end %><br />
<% end end %>
</div>
<br />
<% end %>

<div>
<a href="<%=controller%>/admin/system/packages?update=1"><%:packages_updatelist Paketlisten aktualisieren%></a><br />
<a href="<%=controller%>/admin/system/packages?upgrade=1"><%:packages_upgrade Installierte Pakete aktualisieren%></a>
</div>

<br />
<br />

<form method="post" action="<%=controller%>/admin/system/packages">
	<div>
		<span class="bold"><%:packages_installurl Paket herunterladen und installieren%>:</span><br />
		<input type="text" name="url" size="30" value="" />
		<input type="submit" name="submit" value="<%:ok OK%>" />
	</div>
	
	<br />
	<br />

	<div>
		<span class="bold"><%:filter Filter%>:</span>
		<input type="text" name="query" size="20" value="<%=(query or '')%>" />
		<input type="submit" name="search" value="<%:packages_search Paket suchen%>" />
		<input type="submit" name="submit" value="<%:packages_do Aktionen ausführen%>" />
	</div>
	
	<br />
	<br />
	
	<div>
	<table style="font-size: 0.8em">
		<tr>
			<th><%:packages_name Paketname%></th>
			<th><%:version Version%></th>
			<th><%:install Installieren%></th>
			<th><%:delete Löschen%></th>
			<th><%:descr Beschreibung%></th>
		</tr>
		<% for k, pkg in pairs(pkgs) do %>	
		<tr>
			<td><%=pkg.Package%></td>
			<td><%=(pkg.Version or '')%></td>
			<td><% if not pkg.Status or not pkg.Status.installed then %><input type="checkbox" name="install.<%=pkg.Package%>" value="1" /><% else %><%:installed installiert%><% end %></td>
			<td><% if pkg.Status and pkg.Status.installed then %><input type="checkbox" name="remove.<%=pkg.Package%>" value="1" /><% else %><%:notinstalled nicht installiert%><% end %></td>
			<td><%=(pkg.Description or '')%></td>
		</tr>
		<% end %>
	</table>
	</div>
	<br />
	<input type="submit" name="submit" value="<%:packages_do Aktionen ausführen%>" />
</form>
<%+footer%>